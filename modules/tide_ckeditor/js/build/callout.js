!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.callout=t())}(self,(()=>(()=>{var e={"ckeditor5/src/core.js":(e,t,r)=>{e.exports=r("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/enter.js":(e,t,r)=>{e.exports=r("dll-reference CKEditor5.dll")("./src/enter.js")},"ckeditor5/src/typing.js":(e,t,r)=>{e.exports=r("dll-reference CKEditor5.dll")("./src/typing.js")},"ckeditor5/src/ui.js":(e,t,r)=>{e.exports=r("dll-reference CKEditor5.dll")("./src/ui.js")},"ckeditor5/src/utils.js":(e,t,r)=>{e.exports=r("dll-reference CKEditor5.dll")("./src/utils.js")},"dll-reference CKEditor5.dll":e=>{"use strict";e.exports=CKEditor5.dll}},t={};function r(o){var l=t[o];if(void 0!==l)return l.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";r.d(o,{default:()=>u});var e=r("ckeditor5/src/core.js"),t=r("ckeditor5/src/ui.js");class l extends e.Plugin{init(){const e=this.editor,r=e.t;e.ui.componentFactory.add("Callout",(o=>{const l=e.commands.get("CalloutCommand"),i=new t.ButtonView(o);return i.set({label:r("Callout"),icon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M15.18 17.1665C13.9095 18.3291 12.2849 18.9104 10.3061 18.9104C7.85759 18.9104 5.93267 18.1251 4.53133 16.5543C3.12999 14.9759 2.42932 12.8123 2.42932 10.0635C2.42932 7.09145 3.22624 4.8008 4.82007 3.19156C6.20601 1.79022 7.96924 1.08955 10.1097 1.08955C12.974 1.08955 15.0683 2.02891 16.3927 3.90763C17.1241 4.96249 17.5168 6.02119 17.5707 7.08375H14.0135C13.7825 6.26758 13.4861 5.65161 13.1242 5.23583C12.4774 4.49666 11.5188 4.12707 10.2483 4.12707C8.95479 4.12707 7.93459 4.65065 7.18772 5.69781C6.44085 6.73726 6.06742 8.21175 6.06742 10.1213C6.06742 12.0308 6.4601 13.4629 7.24547 14.4177C8.03853 15.3647 9.04334 15.8383 10.2599 15.8383C11.5072 15.8383 12.4581 15.4302 13.1126 14.614C13.4745 14.1751 13.7748 13.5168 14.0135 12.6391H17.5361C17.2281 14.4947 16.4427 16.0038 15.18 17.1665Z" fill="#333333"/>\n</svg>\n',tooltip:!0,isToggleable:!0}),i.bind("isOn","isEnabled").to(l,"value","isEnabled"),this.listenTo(i,"execute",(()=>{e.execute("CalloutCommand"),e.editing.view.focus()})),i}))}}var i=r("ckeditor5/src/enter.js"),s=r("ckeditor5/src/typing.js"),n=r("ckeditor5/src/utils.js");class c extends e.Command{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,r=t.schema,o=t.document.selection,l=Array.from(o.getSelectedBlocks()),i=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(i){const t=l.filter((e=>this._findCallOut(e)||this._checkCanBeCallOut(r,e)));this._applyCallOut(e,t)}else this._removeCallOut(e,l.filter(this._findCallOut))}))}_getValue(){const e=this.editor.model.document.selection,t=(0,n.first)(e.getSelectedBlocks());return!(!t||!this._findCallOut(t))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,r=(0,n.first)(e.getSelectedBlocks());return!!r&&this._checkCanBeCallOut(t,r)}_removeCallOut(e,t){this._getRangesOfCallOutGroups(e,t).reverse().forEach((t=>{if(t.start.isAtStart&&t.end.isAtEnd)return void e.unwrap(t.start.parent);if(t.start.isAtStart){const r=e.createPositionBefore(t.start.parent);return void e.move(t,r)}t.end.isAtEnd||e.split(t.end);const r=e.createPositionAfter(t.end.parent);e.move(t,r)}))}_applyCallOut(e,t){const r=[];this._getRangesOfCallOutGroups(e,t).reverse().forEach((t=>{let o=this._findCallOut(t.start);o||(o=e.createElement("callOut"),e.wrap(t,o)),r.push(o)})),r.reverse().reduce(((t,r)=>t.nextSibling==r?(e.merge(e.createPositionAfter(t)),t):r))}_findCallOut(e){return"callOut"==e.parent.name?e.parent:null}_getRangesOfCallOutGroups(e,t){let r,o=0;const l=[];for(;o<t.length;){const i=t[o],s=t[o+1];r||(r=e.createPositionBefore(i)),s&&i.nextSibling==s||(l.push(e.createRange(r,e.createPositionAfter(i))),r=null),o++}return l}_checkCanBeCallOut(e,t){const r=e.checkChild(t.parent,"callOut"),o=e.checkChild(["$root","callOut"],t);return r&&o}}class a extends e.Plugin{static get requires(){return[i.Enter,s.Delete]}init(){const e=this.editor,t=e.model.schema;e.commands.add("CalloutCommand",new c(e)),t.register("callOut",{inheritAllFrom:"$container"}),e.conversion.elementToElement({model:"callOut",view:{name:"div",classes:"callout-wrapper"}}),e.model.document.registerPostFixer((r=>{const o=e.model.document.differ.getChanges();for(const e of o)if("insert"==e.type){const o=e.position.nodeAfter;if(!o)continue;if(o.is("element","callOut")&&o.isEmpty)return r.remove(o),!0;if(o.is("element","callOut")&&!t.checkChild(e.position,o))return r.unwrap(o),!0;if(o.is("element")){const e=r.createRangeIn(o);for(const o of e.getItems())if(o.is("element","callOut")&&!t.checkChild(r.createPositionBefore(o),o))return r.unwrap(o),!0}}else if("remove"==e.type){const t=e.position.parent;if(t.is("element","callOut")&&t.isEmpty)return r.remove(t),!0}return!1}));const r=this.editor.editing.view.document,o=e.model.document.selection,l=e.commands.get("callOut");this.listenTo(r,"enter",((t,r)=>{if(!o.isCollapsed||!l.value)return;o.getLastPosition().parent.isEmpty&&(e.execute("callOut"),e.editing.view.scrollToTheSelection(),r.preventDefault(),t.stop())}),{context:"callout"}),this.listenTo(r,"delete",((t,r)=>{if("backward"!=r.direction||!o.isCollapsed||!l.value)return;const i=o.getLastPosition().parent;i.isEmpty&&!i.previousSibling&&(e.execute("callOut"),e.editing.view.scrollToTheSelection(),r.preventDefault(),t.stop())}),{context:"callout"})}}class d extends e.Plugin{static get requires(){return[a,l]}}const u={Callout:d}})(),o=o.default})()));